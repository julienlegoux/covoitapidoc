<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyse UML — API REST Covoiturage</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0d0f;
    --surface: #15151a;
    --surface-2: #1e1e26;
    --surface-3: #25252f;
    --border: #2a2a35;
    --border-glow: #3d3d4d;
    --text: #f0f0f5;
    --text-dim: #7a7a8c;
    --text-muted: #5a5a6b;
    --accent: #00d4aa;
    --accent-2: #7c3aed;
    --accent-3: #f59e0b;
    --accent-glow: rgba(0, 212, 170, 0.15);
    --warn: #fbbf24;
    --danger: #ef4444;
    --danger-glow: rgba(239, 68, 68, 0.15);
    --info: #3b82f6;
    --info-glow: rgba(59, 130, 246, 0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.7;
    overflow-x: hidden;
    background-image: 
      radial-gradient(ellipse 80% 50% at 50% -20%, rgba(0, 212, 170, 0.08), transparent),
      radial-gradient(ellipse 60% 40% at 80% 100%, rgba(124, 58, 237, 0.06), transparent);
  }

  .hero {
    padding: 80px 40px 60px;
    text-align: center;
    position: relative;
    overflow: hidden;
    background: 
      radial-gradient(ellipse 100% 100% at 50% 0%, rgba(0, 212, 170, 0.12) 0%, transparent 50%),
      radial-gradient(ellipse 80% 60% at 50% 100%, rgba(124, 58, 237, 0.15) 0%, transparent 50%),
      linear-gradient(180deg, #0a0a0c 0%, var(--bg) 100%);
    border-bottom: 1px solid var(--border);
  }

  .hero::before {
    content: '';
    position: absolute;
    inset: 0;
    background: 
      repeating-linear-gradient(90deg, var(--border) 0px, var(--border) 1px, transparent 1px, transparent 80px),
      repeating-linear-gradient(0deg, var(--border) 0px, var(--border) 1px, transparent 1px, transparent 80px);
    opacity: 0.15;
    mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black, transparent);
    -webkit-mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black, transparent);
  }

  .hero h1 {
    font-family: 'Playfair Display', serif;
    font-size: 3.2rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent) 0%, #fff 50%, var(--accent-2) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    position: relative;
    margin-bottom: 12px;
    filter: drop-shadow(0 0 40px rgba(0, 212, 170, 0.3));
  }

  .hero .subtitle {
    font-size: 1.1rem;
    color: var(--text-dim);
    position: relative;
    font-weight: 400;
    letter-spacing: 0.02em;
  }

  .hero .badges {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 24px;
    position: relative;
    flex-wrap: wrap;
  }

  .badge {
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.5px;
  }

  .badge.hono { background: var(--accent-glow); color: var(--accent); border: 1px solid rgba(0, 212, 170, 0.35); box-shadow: 0 0 20px rgba(0, 212, 170, 0.1); }
  .badge.prisma { background: rgba(124, 58, 237, 0.15); color: #a78bfa; border: 1px solid rgba(124, 58, 237, 0.35); box-shadow: 0 0 20px rgba(124, 58, 237, 0.1); }
  .badge.neon { background: rgba(245, 158, 11, 0.15); color: var(--accent-3); border: 1px solid rgba(245, 158, 11, 0.35); box-shadow: 0 0 20px rgba(245, 158, 11, 0.1); }
  .badge.clean { background: rgba(239, 68, 68, 0.15); color: var(--danger); border: 1px solid rgba(239, 68, 68, 0.35); box-shadow: 0 0 20px rgba(239, 68, 68, 0.1); }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 32px;
  }

  nav.toc {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(13, 13, 15, 0.85);
    backdrop-filter: blur(20px) saturate(180%);
    border-bottom: 1px solid var(--border);
    padding: 12px 0;
  }

  nav.toc .container {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    scrollbar-width: none;
  }

  nav.toc a {
    color: var(--text-dim);
    text-decoration: none;
    font-size: 0.82rem;
    font-weight: 500;
    padding: 6px 14px;
    border-radius: 8px;
    white-space: nowrap;
    transition: all 0.25s ease;
    border: 1px solid transparent;
  }

  nav.toc a:hover {
    background: var(--surface-2);
    color: var(--accent);
    border-color: var(--border-glow);
  }

  section {
    padding: 60px 0;
    border-bottom: 1px solid var(--border);
    position: relative;
  }

  section::before {
    content: '';
    position: absolute;
    left: 50%;
    top: 0;
    transform: translateX(-50%);
    width: 1px;
    height: 60px;
    background: linear-gradient(180deg, var(--accent), transparent);
    opacity: 0.5;
  }

  section:last-child { border-bottom: none; }

  h2 {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 8px;
    color: var(--text);
    letter-spacing: -0.01em;
  }

  h2 .num {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    color: var(--accent);
    display: block;
    margin-bottom: 4px;
    font-weight: 500;
    text-shadow: 0 0 20px rgba(0, 212, 170, 0.4);
  }

  h3 {
    font-size: 1.15rem;
    font-weight: 600;
    color: var(--accent);
    margin: 32px 0 12px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  h3::before {
    content: '';
    width: 4px;
    height: 18px;
    background: linear-gradient(180deg, var(--accent), var(--accent-2));
    border-radius: 2px;
  }

  .section-desc {
    color: var(--text-dim);
    margin-bottom: 32px;
    font-size: 0.95rem;
    max-width: 700px;
  }

  .diagram-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 32px;
    margin: 24px 0;
    overflow-x: auto;
    box-shadow: 
      0 4px 6px -1px rgba(0, 0, 0, 0.3),
      0 2px 4px -2px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.03);
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }

  .diagram-card:hover {
    border-color: var(--border-glow);
    box-shadow: 
      0 8px 12px -2px rgba(0, 0, 0, 0.4),
      0 4px 8px -4px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }

  .diagram-card .mermaid {
    display: flex;
    justify-content: center;
  }

  .diagram-card .mermaid svg {
    max-width: 100%;
  }

  .entity-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
    margin: 24px 0;
  }

  .entity-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  }

  .entity-card:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 212, 170, 0.1), 0 4px 8px rgba(0, 0, 0, 0.3);
  }

  .entity-card .header {
    padding: 14px 20px;
    font-weight: 700;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 10px;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(90deg, var(--surface-2), var(--surface));
  }

  .entity-card .header .icon {
    width: 28px;
    height: 28px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-family: 'JetBrains Mono', monospace;
    font-weight: 600;
  }

  .entity-card .fields {
    padding: 12px 20px;
  }

  .field {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 5px 0;
    font-size: 0.85rem;
    font-family: 'JetBrains Mono', monospace;
  }

  .field .type {
    color: var(--accent);
    min-width: 80px;
    font-size: 0.78rem;
  }

  .field .name { color: var(--text); }

  .field .pk {
    font-size: 0.65rem;
    padding: 2px 6px;
    border-radius: 4px;
    background: rgba(245, 158, 11, 0.2);
    color: var(--accent-3);
    font-weight: 600;
    border: 1px solid rgba(245, 158, 11, 0.3);
  }

  .field .fk {
    font-size: 0.65rem;
    padding: 2px 6px;
    border-radius: 4px;
    background: rgba(59, 130, 246, 0.2);
    color: var(--info);
    font-weight: 600;
    border: 1px solid rgba(59, 130, 246, 0.3);
  }

  .routes-table {
    width: 100%;
    border-collapse: collapse;
    margin: 24px 0;
    font-size: 0.88rem;
  }

  .routes-table th {
    text-align: left;
    padding: 12px 16px;
    font-weight: 600;
    color: var(--text-dim);
    border-bottom: 2px solid var(--border);
    font-size: 0.78rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .routes-table td {
    padding: 10px 16px;
    border-bottom: 1px solid var(--border);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.82rem;
  }

  .routes-table tr:hover td { 
    background: var(--accent-glow);
  }

  .method {
    padding: 3px 10px;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.72rem;
    letter-spacing: 0.5px;
  }

  .method.get { background: rgba(245, 158, 11, 0.15); color: var(--accent-3); border: 1px solid rgba(245, 158, 11, 0.25); }
  .method.post { background: rgba(0, 212, 170, 0.15); color: var(--accent); border: 1px solid rgba(0, 212, 170, 0.25); }
  .method.put { background: rgba(124, 58, 237, 0.15); color: #a78bfa; border: 1px solid rgba(124, 58, 237, 0.25); }
  .method.patch { background: rgba(59, 130, 246, 0.15); color: var(--info); border: 1px solid rgba(59, 130, 246, 0.25); }
  .method.delete { background: rgba(239, 68, 68, 0.15); color: var(--danger); border: 1px solid rgba(239, 68, 68, 0.25); }

  .arch-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 16px;
    margin: 24px 0;
  }

  .arch-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  }

  .arch-card:hover {
    border-color: var(--border-glow);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  }

  .arch-card h4 {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .arch-card p {
    font-size: 0.83rem;
    color: var(--text-dim);
    line-height: 1.6;
  }

  .arch-card code {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.78rem;
    background: var(--surface-3);
    padding: 2px 6px;
    border-radius: 4px;
    color: var(--accent);
    border: 1px solid var(--border);
  }

  .folder-tree {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.82rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    line-height: 1.9;
    color: var(--text-dim);
    overflow-x: auto;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
  }

  .folder-tree .dir { color: var(--accent); font-weight: 500; }
  .folder-tree .file { color: var(--text); }
  .folder-tree .comment { color: var(--text-muted); }
</style>
</head>
<body>

<div class="hero">
  <h1>API REST Covoiturage</h1>
  <p class="subtitle">Analyse UML complète — Entités, Use Cases, Séquences & Classes</p>
  <div class="badges">
    <span class="badge hono">Hono</span>
    <span class="badge prisma">Prisma ORM</span>
    <span class="badge neon">Neon PostgreSQL</span>
    <span class="badge clean">Clean Architecture</span>
  </div>
</div>

<nav class="toc">
  <div class="container">
    <a href="#entities">Entités</a>
    <a href="#usecase">Use Cases</a>
    <a href="#class">Diagramme de Classes</a>
    <a href="#sequence">Séquences</a>
    <a href="#erd">ERD / MCD</a>
    <a href="#routes">Routes API</a>
    <a href="#archi">Architecture</a>
  </div>
</nav>

<!-- ===================== ENTITÉS ===================== -->
<section id="entities">
<div class="container">
  <h2><span class="num">01</span>Entités du Domaine</h2>
  <p class="section-desc">Les entités métier extraites du cahier des charges, avec leurs attributs et relations.</p>

  <div class="entity-grid">

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(108,140,255,0.15);color:var(--accent);">A</div>
        Auth (Authentification)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">email</span></div>
        <div class="field"><span class="type">String</span><span class="name">password</span></div>
        <div class="field"><span class="type">Role</span><span class="name">role</span></div>
        <div class="field"><span class="type">DateTime?</span><span class="name">anonymizedAt</span></div>
        <div class="field"><span class="type">DateTime</span><span class="name">createdAt</span></div>
        <div class="field"><span class="type">DateTime</span><span class="name">updatedAt</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(52,211,153,0.15);color:var(--accent);">U</div>
        User (Utilisateur)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String?</span><span class="name">firstName</span></div>
        <div class="field"><span class="type">String?</span><span class="name">lastName</span></div>
        <div class="field"><span class="type">String?</span><span class="name">phone</span></div>
        <div class="field"><span class="type">Int</span><span class="name">authRefId</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">DateTime?</span><span class="name">anonymizedAt</span></div>
        <div class="field"><span class="type">DateTime</span><span class="name">createdAt</span></div>
        <div class="field"><span class="type">DateTime</span><span class="name">updatedAt</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(167,139,250,0.15);color:var(--accent-2);">D</div>
        Driver (Conducteur)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">driverLicense</span></div>
        <div class="field"><span class="type">Int</span><span class="name">userRefId</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">DateTime?</span><span class="name">anonymizedAt</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(52,211,153,0.15);color:var(--accent-3);">T</div>
        Travel (Trajet)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">DateTime</span><span class="name">dateRoute</span></div>
        <div class="field"><span class="type">Int</span><span class="name">kms</span></div>
        <div class="field"><span class="type">Int</span><span class="name">seats</span></div>
        <div class="field"><span class="type">Int</span><span class="name">driverRefId</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">carRefId</span><span class="fk">FK</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(244,114,182,0.15);color:var(--danger);">I</div>
        Inscription (Reservation)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">Int</span><span class="name">userRefId</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">routeRefId</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">Status</span><span class="name">status</span></div>
        <div class="field"><span class="type">DateTime</span><span class="name">createdAt</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(248,113,113,0.15);color:var(--danger);">V</div>
        City (Ville)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">cityName</span></div>
        <div class="field"><span class="type">String</span><span class="name">zipcode</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(59,130,246,0.15);color:var(--info);">CT</div>
        CityTravel (Ville-Trajet)
      </div>
      <div class="fields">
        <div class="field"><span class="type">Int</span><span class="name">routeRefId</span><span class="pk">PK</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">cityRefId</span><span class="pk">PK</span><span class="fk">FK</span></div>
        <div class="field"><span class="type">Enum</span><span class="name">type</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(251,191,36,0.15);color:var(--warn);">C</div>
        Car (Voiture)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">immat</span></div>
        <div class="field"><span class="type">Int</span><span class="name">modelRefId</span><span class="fk">FK</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(245,158,11,0.15);color:var(--accent-3);">M</div>
        Model (Modele)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">name</span></div>
        <div class="field"><span class="type">Int</span><span class="name">brandRefId</span><span class="fk">FK</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(167,139,250,0.15);color:var(--accent-2);">B</div>
        Brand (Marque)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">name</span></div>
      </div>
    </div>

    <div class="entity-card">
      <div class="header">
        <div class="icon" style="background:rgba(0,212,170,0.15);color:var(--accent);">Co</div>
        Color (Couleur)
      </div>
      <div class="fields">
        <div class="field"><span class="type">UUID</span><span class="name">id</span><span class="pk">PK</span></div>
        <div class="field"><span class="type">Int</span><span class="name">refId</span></div>
        <div class="field"><span class="type">String</span><span class="name">name</span></div>
        <div class="field"><span class="type">String</span><span class="name">hex</span></div>
      </div>
    </div>

  </div>
</div>
</section>

<!-- ===================== USE CASES ===================== -->
<section id="usecase">
<div class="container">
  <h2><span class="num">02</span>Diagrammes de Cas d'Utilisation</h2>
  <p class="section-desc">Les cas d'utilisation identifiés pour les trois acteurs : Utilisateur, Conducteur et Administrateur.</p>

  <h3>Use Case — Authentification & Inscription</h3>
  <div class="diagram-card">
    <div class="mermaid">
graph LR
    User((Utilisateur))
    Admin((Admin))

    UC1[Authentification]
    UC2[Inscription]
    UC3[Confirmation Registration]

    User --> UC1
    User --> UC2
    Admin --> UC1
    UC1 -.extend.-> UC2
    UC2 -.include.-> UC3
    </div>
  </div>

  <h3>Use Case — Accueil (Utilisateur Authentifie)</h3>
  <div class="diagram-card">
    <div class="mermaid">
graph LR
    User((Utilisateur))
    Driver((Conducteur))

    UC0[Authentification]
    UC1[Accueil]
    UC2[Liste des Trajets]
    UC3[Rechercher un Trajet]
    UC4[Reserver une Place]
    UC5[Mon Compte]
    UC6[Devenir Conducteur]
    UC7[Publier un Trajet]
    UC8[Gerer mes Voitures]

    User --> UC1
    Driver --> UC7
    Driver --> UC8
    UC1 -.include.-> UC0
    UC1 -.include.-> UC2
    UC1 -.extend.-> UC3
    UC1 -.extend.-> UC4
    UC1 -.extend.-> UC5
    UC1 -.extend.-> UC6
    </div>
  </div>

  <h3>Use Case — Detail & Reservation d'un Trajet</h3>
  <div class="diagram-card">
    <div class="mermaid">
graph LR
    User((Utilisateur))

    UC1[Liste des Trajets]
    UC2[Detail d un Trajet]
    UC3[Reserver une Place]
    UC4[Annuler une Reservation]

    User --> UC1
    UC1 -.extend.-> UC2
    UC2 -.extend.-> UC3
    UC2 -.extend.-> UC4
    </div>
  </div>

  <h3>Use Case — Gestion des Trajets (Conducteur)</h3>
  <div class="diagram-card">
    <div class="mermaid">
graph LR
    Driver((Conducteur))

    UC1[Mes Trajets]
    UC2[Voir les Passagers]
    UC3[Publier un Trajet]
    UC4[Creer un Trajet]
    UC5[Supprimer un Trajet]
    UC6[Gerer mes Voitures]
    UC7[Ajouter une Voiture]
    UC8[Modifier une Voiture]
    UC9[Supprimer une Voiture]

    Driver --> UC1
    Driver --> UC3
    Driver --> UC6
    UC1 -.extend.-> UC2
    UC3 -.extend.-> UC4
    UC3 -.extend.-> UC5
    UC6 -.extend.-> UC7
    UC6 -.extend.-> UC8
    UC6 -.extend.-> UC9
    </div>
  </div>

  <h3>Use Case — Mon Compte & RGPD</h3>
  <div class="diagram-card">
    <div class="mermaid">
graph LR
    User((Utilisateur))

    UC1[Informations de mon compte]
    UC2[Modifier mon profil]
    UC3[Anonymiser mon compte RGPD]

    User --> UC1
    UC1 -.extend.-> UC2
    UC1 -.extend.-> UC3
    </div>
  </div>

  <h3>Use Case — Administration</h3>
  <div class="diagram-card">
    <div class="mermaid">
graph LR
    Admin((Admin))

    UC1[Liste des Utilisateurs]
    UC2[Supprimer un Utilisateur]
    UC3[Gerer les Marques]
    UC4[Gerer les Villes]
    UC5[Ajouter une Marque]
    UC6[Supprimer une Marque]
    UC7[Ajouter une Ville]
    UC8[Supprimer une Ville]

    Admin --> UC1
    Admin --> UC3
    Admin --> UC4
    UC1 -.extend.-> UC2
    UC3 -.extend.-> UC5
    UC3 -.extend.-> UC6
    UC4 -.extend.-> UC7
    UC4 -.extend.-> UC8
    </div>
  </div>
</div>
</section>

<!-- ===================== CLASS DIAGRAM ===================== -->
<section id="class">
<div class="container">
  <h2><span class="num">03</span>Diagramme de Classes</h2>
  <p class="section-desc">Relations entre les classes du domaine métier avec multiplicités.</p>

  <div class="diagram-card">
    <div class="mermaid">
classDiagram
    class Auth {
        +UUID id
        +Int refId
        +String email
        +String password
        +Role role
        +DateTime anonymizedAt
        +register(email, password) Auth
        +login(email, password) Token
    }

    class User {
        +UUID id
        +Int refId
        +String firstName
        +String lastName
        +String phone
        +Int authRefId
        +DateTime anonymizedAt
        +updateProfile() User
        +anonymize() void
    }

    class Driver {
        +UUID id
        +Int refId
        +String driverLicense
        +Int userRefId
        +DateTime anonymizedAt
        +create(driverLicense) Driver
    }

    class Travel {
        +UUID id
        +Int refId
        +DateTime dateRoute
        +Int kms
        +Int seats
        +Int driverRefId
        +Int carRefId
        +create() Travel
        +delete() void
        +search(departure, arrival, date) Travel[]
    }

    class Inscription {
        +UUID id
        +Int refId
        +Int userRefId
        +Int routeRefId
        +InscriptionStatus status
        +DateTime createdAt
        +create() Inscription
        +delete() void
    }

    class City {
        +UUID id
        +Int refId
        +String cityName
        +String zipcode
        +create() City
        +delete() void
    }

    class CityTravel {
        +Int routeRefId
        +Int cityRefId
        +CityTravelType type
    }

    class Car {
        +UUID id
        +Int refId
        +String immat
        +Int modelRefId
        +create() Car
        +update() Car
        +delete() void
    }

    class Model {
        +UUID id
        +Int refId
        +String name
        +Int brandRefId
    }

    class Brand {
        +UUID id
        +Int refId
        +String name
        +create() Brand
        +delete() void
    }

    class Color {
        +UUID id
        +Int refId
        +String name
        +String hex
        +create() Color
        +update() Color
        +delete() void
    }

    Auth "1" --> "1" User : authentifie
    User "1" --> "0..1" Driver : devient conducteur
    User "1" --> "*" Inscription : reserve
    Driver "1" --> "*" Travel : publie
    Travel "1" --> "*" Inscription : contient
    Travel "1" --> "2" CityTravel : depart et arrivee
    Travel "*" --> "1" Car : utilise
    City "1" --> "*" CityTravel : reference
    Car "*" --> "1" Model : est un modele
    Model "*" --> "1" Brand : est de marque
    Model "*" --> "*" Color : disponible en
    </div>
  </div>
</div>
</section>

<!-- ===================== SEQUENCE DIAGRAMS ===================== -->
<section id="sequence">
<div class="container">
  <h2><span class="num">04</span>Diagrammes de Séquence</h2>
  <p class="section-desc">Flux d'interactions détaillés pour chaque cas d'utilisation principal.</p>

  <h3>Sequence — Authentification (Login)</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Saisit email + password
    App->>API: POST /api/auth/login {email, password}
    API->>DB: SELECT auth WHERE email = ?
    DB-->>API: Auth trouve
    alt Password correct (Argon2)
        API->>API: Genere token JWT
        API-->>App: 200 {token, userId}
        App-->>U: Redirection Accueil
    else Password incorrect
        API-->>App: 401 {error INVALID_CREDENTIALS}
        App-->>U: Affiche message erreur
    end
    </div>
  </div>

  <h3>Sequence — Inscription (Register)</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Saisit email, password, confirmPassword
    App->>API: POST /api/auth/register {email, password, confirmPassword}
    API->>API: Validation Zod (email, password min 8 chars)
    alt Validation echouee
        API-->>App: 400 {error VALIDATION_ERROR}
        App-->>U: Affiche erreurs
    else Validation OK
        API->>DB: SELECT auth WHERE email = ?
        alt Email deja utilise
            API-->>App: 409 {error USER_ALREADY_EXISTS}
        else Email disponible
            API->>API: Hash password (Argon2)
            API->>DB: INSERT INTO auths + INSERT INTO users
            DB-->>API: Auth + User crees
            API->>API: Genere token JWT
            API-->>App: 201 {token, userId}
            App-->>U: Redirection Accueil
        end
    end
    </div>
  </div>

  <h3>Sequence — Liste des Trajets</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Accede a la liste des trajets
    App->>API: GET /api/travels?page=1&limit=10 (x-auth-token)
    API->>API: authMiddleware verifie JWT
    alt Token valide
        API->>API: requireRole USER
        API->>DB: SELECT travels + JOIN driver, car, cities
        DB-->>API: Liste paginee des trajets
        API-->>App: 200 {items, total, page, limit}
        App-->>U: Affiche liste des trajets
    else Token invalide
        API-->>App: 401 {error UNAUTHORIZED}
    end
    </div>
  </div>

  <h3>Sequence — Detail Trajet</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Clic sur un trajet
    App->>API: GET /api/travels/:id (x-auth-token)
    API->>API: authMiddleware + requireRole USER
    API->>DB: SELECT travel WHERE id + JOIN driver, car, cities
    DB-->>API: Detail du trajet complet
    API-->>App: 200 {travel + driver + car + cities}
    App-->>U: Affiche detail du trajet
    </div>
  </div>

  <h3>Sequence — Reserver une Place</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Clic Reserver
    App->>API: POST /api/inscriptions {travelId} (x-auth-token)
    API->>API: authMiddleware + requireRole USER
    API->>DB: SELECT travel WHERE id = travelId
    DB-->>API: Travel trouve
    API->>DB: COUNT inscriptions WHERE routeRefId = ?
    DB-->>API: Nombre de reservations

    alt Places disponibles et pas deja inscrit
        API->>DB: INSERT INTO inscriptions
        DB-->>API: Inscription creee
        API-->>App: 201 {inscription}
        App-->>U: Reservation effectuee
    else Deja inscrit
        API-->>App: 409 {error ALREADY_INSCRIBED}
        App-->>U: Deja inscrit a ce trajet
    else Plus de place
        API-->>App: 400 {error NO_SEATS_AVAILABLE}
        App-->>U: Reservation impossible
    end
    </div>
  </div>

  <h3>Sequence — Rechercher un Trajet</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Saisit ville depart, ville arrivee, date
    App->>API: GET /api/travels/search?departureCity=X&arrivalCity=Y&date=Z
    API->>API: authMiddleware + requireRole USER
    API->>DB: SELECT travels WHERE cities match AND date
    DB-->>API: Resultats
    API-->>App: 200 [{travel1}, {travel2}, ...]
    App-->>U: Affiche resultats de recherche
    </div>
  </div>

  <h3>Sequence — Publier un Trajet (Conducteur)</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor D as Conducteur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    D->>App: Saisit depart, arrivee, date, kms, seats, carId
    App->>API: POST /api/travels {kms, date, departureCity, arrivalCity, seats, carId}
    API->>API: authMiddleware + requireRole DRIVER
    API->>API: Validation Zod
    API->>DB: INSERT INTO routes + city_routes
    DB-->>API: Travel cree
    API-->>App: 201 {travel + driver + car + cities}
    App-->>D: Redirection vers Mes Trajets
    </div>
  </div>

  <h3>Sequence — Supprimer un Trajet (Conducteur)</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor D as Conducteur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    D->>App: Clic Supprimer le trajet
    App->>API: DELETE /api/travels/:id (x-auth-token)
    API->>API: authMiddleware + requireRole DRIVER
    API->>DB: DELETE FROM routes WHERE id (CASCADE inscriptions + city_routes)
    DB-->>API: OK
    API-->>App: 204 No Content
    App-->>D: Redirection vers Mes Trajets
    </div>
  </div>

  <h3>Sequence — Devenir Conducteur</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Saisit numero de permis
    App->>API: POST /api/drivers {driverLicense} (x-auth-token)
    API->>API: authMiddleware + requireRole USER
    alt Deja conducteur
        API-->>App: 409 {error DRIVER_ALREADY_EXISTS}
    else Nouveau conducteur
        API->>DB: INSERT INTO drivers
        DB-->>API: Driver cree
        API->>DB: UPDATE auth SET role = DRIVER
        DB-->>API: Role mis a jour
        API-->>App: 201 {driver}
        App-->>U: Statut conducteur active
    end
    </div>
  </div>

  <h3>Sequence — Anonymisation RGPD</h3>
  <div class="diagram-card">
    <div class="mermaid">
sequenceDiagram
    actor U as Utilisateur
    participant App as Application Mobile
    participant API as API REST Hono
    participant DB as Neon PostgreSQL

    U->>App: Demande suppression de compte
    App->>API: DELETE /api/users/me (x-auth-token)
    API->>API: authMiddleware + requireRole USER
    API->>DB: UPDATE user SET anonymizedAt, clear personal data
    DB-->>API: OK
    API->>DB: UPDATE auth SET anonymizedAt, clear email/password
    DB-->>API: OK
    API->>DB: UPDATE inscriptions SET status ANONYMIZED
    DB-->>API: OK
    API-->>App: 204 No Content
    App-->>U: Compte anonymise
    </div>
  </div>

</div>
</section>

<!-- ===================== ERD ===================== -->
<section id="erd">
<div class="container">
  <h2><span class="num">05</span>ERD — Modèle Conceptuel de Données</h2>
  <p class="section-desc">Schéma entité-relation avec cardinalités pour la base Neon PostgreSQL.</p>

  <div class="diagram-card">
    <div class="mermaid">
erDiagram
    AUTH {
        uuid id PK
        int ref_id UK
        string email UK
        string password
        enum role
        datetime anonymized_at
        datetime created_at
        datetime updated_at
    }

    USER {
        uuid id PK
        int ref_id UK
        string first_name
        string last_name
        string phone
        int auth_ref_id FK
        datetime anonymized_at
        datetime created_at
        datetime updated_at
    }

    DRIVER {
        uuid id PK
        int ref_id UK
        string driver_license UK
        int user_ref_id FK
        datetime anonymized_at
    }

    TRAVEL {
        uuid id PK
        int ref_id UK
        datetime date_route
        int kms
        int seats
        int driver_ref_id FK
        int car_ref_id FK
    }

    INSCRIPTION {
        uuid id PK
        int ref_id UK
        int user_ref_id FK
        int route_ref_id FK
        enum status
        datetime created_at
    }

    CITY {
        uuid id PK
        int ref_id UK
        string city_name
        string zipcode
    }

    CITY_TRAVEL {
        int route_ref_id PK
        int city_ref_id PK
        enum type
    }

    CAR {
        uuid id PK
        int ref_id UK
        string immat UK
        int model_ref_id FK
    }

    MODEL {
        uuid id PK
        int ref_id UK
        string name
        int brand_ref_id FK
    }

    BRAND {
        uuid id PK
        int ref_id UK
        string name
    }

    COLOR {
        uuid id PK
        int ref_id UK
        string name
        string hex
    }

    COLOR_MODEL {
        int color_ref_id PK
        int model_ref_id PK
    }

    AUTH ||--|| USER : "authentifie (1,1)"
    USER ||--o| DRIVER : "devient (0,1)"
    USER ||--o{ INSCRIPTION : "reserve (0,n)"
    DRIVER ||--o{ TRAVEL : "publie (0,n)"
    TRAVEL ||--o{ INSCRIPTION : "contient (0,n)"
    TRAVEL ||--|{ CITY_TRAVEL : "depart et arrivee (1,2)"
    TRAVEL }o--|| CAR : "utilise (1,1)"
    CITY ||--o{ CITY_TRAVEL : "reference (0,n)"
    CAR }o--|| MODEL : "modele (1,1)"
    MODEL }o--|| BRAND : "marque (1,1)"
    MODEL ||--o{ COLOR_MODEL : "disponible (0,n)"
    COLOR ||--o{ COLOR_MODEL : "associe (0,n)"
    </div>
  </div>
</div>
</section>

<!-- ===================== ROUTES ===================== -->
<section id="routes">
<div class="container">
  <h2><span class="num">06</span>Routes de l'API REST</h2>
  <p class="section-desc">Ensemble des endpoints de l'API REST, organises par ressource avec controle d'acces par role (USER / DRIVER / ADMIN).</p>

  <div class="diagram-card" style="padding:16px;">
    <table class="routes-table">
      <thead>
        <tr><th>Methode</th><th>Route</th><th>Auth</th><th>Parametres</th><th>Description</th></tr>
      </thead>
      <tbody>
        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Authentification</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/auth/register</td><td>Public</td><td>email, password, confirmPassword</td><td>Inscription utilisateur</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/auth/login</td><td>Public</td><td>email, password</td><td>Authentification &rarr; JWT token</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Utilisateurs</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/users</td><td>ADMIN</td><td>?page, ?limit</td><td>Liste de tous les utilisateurs</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/users/:id</td><td>USER</td><td>id (UUID)</td><td>Detail d'un utilisateur</td></tr>
        <tr><td><span class="method patch">PATCH</span></td><td>/api/users/me</td><td>USER</td><td>?firstName, ?lastName, ?phone</td><td>Modifier mon profil</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/users/me</td><td>USER</td><td>&mdash;</td><td>Anonymiser mon compte (RGPD)</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/users/:id</td><td>ADMIN</td><td>id (UUID)</td><td>Anonymiser un utilisateur</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Conducteurs</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/drivers</td><td>USER</td><td>driverLicense</td><td>Devenir conducteur</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Trajets</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/travels</td><td>USER</td><td>?page, ?limit</td><td>Liste des trajets (pagine)</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/travels/search</td><td>USER</td><td>?departureCity, ?arrivalCity, ?date</td><td>Rechercher un trajet</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/travels/:id</td><td>USER</td><td>id (UUID)</td><td>Detail d'un trajet</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/travels</td><td>DRIVER</td><td>kms, date, departureCity, arrivalCity, seats, carId</td><td>Publier un trajet</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/travels/:id</td><td>DRIVER</td><td>id (UUID)</td><td>Supprimer un trajet</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Inscriptions (Reservations)</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/inscriptions</td><td>USER</td><td>?page, ?limit</td><td>Liste des reservations</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/inscriptions</td><td>USER</td><td>travelId</td><td>Reserver une place</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/inscriptions/:id</td><td>USER</td><td>id (UUID)</td><td>Annuler une reservation</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Routes imbriquees</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/users/:id/inscriptions</td><td>USER</td><td>id (UUID), ?page, ?limit</td><td>Reservations d'un utilisateur</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/travels/:id/passengers</td><td>USER</td><td>id (UUID), ?page, ?limit</td><td>Passagers d'un trajet</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Marques</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/brands</td><td>DRIVER</td><td>?page, ?limit</td><td>Liste des marques</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/brands</td><td>ADMIN</td><td>name</td><td>Ajouter une marque</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/brands/:id</td><td>ADMIN</td><td>id (UUID)</td><td>Supprimer une marque</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Voitures</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/cars</td><td>DRIVER</td><td>?page, ?limit</td><td>Liste des voitures</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/cars</td><td>DRIVER</td><td>model, brandId, licensePlate</td><td>Ajouter une voiture</td></tr>
        <tr><td><span class="method put">PUT</span></td><td>/api/cars/:id</td><td>DRIVER</td><td>model, brandId, licensePlate</td><td>Modifier voiture (complet)</td></tr>
        <tr><td><span class="method patch">PATCH</span></td><td>/api/cars/:id</td><td>DRIVER</td><td>?model, ?brandId, ?licensePlate</td><td>Modifier voiture (partiel)</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/cars/:id</td><td>DRIVER</td><td>id (UUID)</td><td>Supprimer une voiture</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Villes</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/cities</td><td>USER</td><td>?page, ?limit</td><td>Liste des villes</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/cities</td><td>USER</td><td>cityName, zipcode</td><td>Ajouter une ville</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/cities/:id</td><td>ADMIN</td><td>id (UUID)</td><td>Supprimer une ville</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Couleurs</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/colors</td><td>DRIVER</td><td>?page, ?limit</td><td>Liste des couleurs</td></tr>
        <tr><td><span class="method post">POST</span></td><td>/api/colors</td><td>DRIVER</td><td>name, hex</td><td>Ajouter une couleur</td></tr>
        <tr><td><span class="method patch">PATCH</span></td><td>/api/colors/:id</td><td>DRIVER</td><td>?name, ?hex</td><td>Modifier une couleur</td></tr>
        <tr><td><span class="method delete">DELETE</span></td><td>/api/colors/:id</td><td>DRIVER</td><td>id (UUID)</td><td>Supprimer une couleur</td></tr>

        <tr><td colspan="5" style="color:var(--accent);font-weight:600;padding-top:16px;border:none;">Systeme</td></tr>
        <tr><td><span class="method get">GET</span></td><td>/api/health</td><td>Public</td><td>&mdash;</td><td>Health check</td></tr>
      </tbody>
    </table>
  </div>
</div>
</section>

<!-- ===================== ARCHITECTURE ===================== -->
<section id="archi">
<div class="container">
  <h2><span class="num">07</span>Architecture Clean — Hono + Prisma + Neon</h2>
  <p class="section-desc">Organisation du projet en couches (Clean Architecture + SOLID) avec injection de dependances.</p>

  <div class="arch-grid">
    <div class="arch-card">
      <h4>Domain Layer</h4>
      <p>Entites metier pures, interfaces de repositories, et services abstraits. Aucune dependance externe. Contient <code>entities/</code>, <code>repositories/</code> (interfaces), <code>services/</code> (JwtService, PasswordService, EmailService).</p>
    </div>
    <div class="arch-card">
      <h4>Application Layer</h4>
      <p>Use cases organises par domaine (auth, user, driver, travel, inscription, car, brand, city, color). Contient <code>use-cases/</code> et <code>dtos/</code>. Chaque use case a ses tests unitaires.</p>
    </div>
    <div class="arch-card">
      <h4>Infrastructure Layer</h4>
      <p>Implementations concretes : Prisma repositories, Argon2 password hashing, Hono JWT, Resend email. Contient <code>database/prisma/</code> (schema, migrations), <code>database/repositories/</code>, <code>services/</code>.</p>
    </div>
    <div class="arch-card">
      <h4>Presentation Layer</h4>
      <p>Routes Hono, controllers, middlewares (auth JWT, authorization par role, error handler, request logger), validators Zod. Contient <code>routes/</code>, <code>controllers/</code>, <code>middleware/</code>, <code>validators/</code>.</p>
    </div>
    <div class="arch-card">
      <h4>Lib (Shared)</h4>
      <p>Utilitaires partages : systeme d'erreurs type, logging structure, conteneur DI (<code>container.ts</code> + <code>tokens.ts</code>), types Result, pagination, et result-response.</p>
    </div>
  </div>

  <h3>Structure de Fichiers</h3>
  <div class="folder-tree">
<span class="dir">src/</span>
├── <span class="file">index.ts</span>                           <span class="comment"># Point d entree Hono</span>
│
├── <span class="dir">domain/</span>                            <span class="comment"># Couche metier pure</span>
│   ├── <span class="dir">entities/</span>
│   │   ├── <span class="file">auth.entity.ts</span>
│   │   ├── <span class="file">user.entity.ts</span>
│   │   ├── <span class="file">driver.entity.ts</span>
│   │   ├── <span class="file">travel.entity.ts</span>
│   │   ├── <span class="file">inscription.entity.ts</span>
│   │   ├── <span class="file">car.entity.ts</span>
│   │   ├── <span class="file">model.entity.ts</span>
│   │   ├── <span class="file">brand.entity.ts</span>
│   │   ├── <span class="file">color.entity.ts</span>
│   │   ├── <span class="file">city.entity.ts</span>
│   │   └── <span class="file">city-travel.entity.ts</span>
│   ├── <span class="dir">repositories/</span>              <span class="comment"># Interfaces (contrats)</span>
│   │   ├── <span class="file">auth.repository.ts</span>
│   │   ├── <span class="file">user.repository.ts</span>
│   │   ├── <span class="file">driver.repository.ts</span>
│   │   ├── <span class="file">travel.repository.ts</span>
│   │   ├── <span class="file">inscription.repository.ts</span>
│   │   ├── <span class="file">car.repository.ts</span>
│   │   ├── <span class="file">model.repository.ts</span>
│   │   ├── <span class="file">brand.repository.ts</span>
│   │   ├── <span class="file">color.repository.ts</span>
│   │   └── <span class="file">city.repository.ts</span>
│   └── <span class="dir">services/</span>                  <span class="comment"># Interfaces services</span>
│       ├── <span class="file">jwt.service.ts</span>
│       ├── <span class="file">password.service.ts</span>
│       └── <span class="file">email.service.ts</span>
│
├── <span class="dir">application/</span>                       <span class="comment"># Use cases & DTOs</span>
│   ├── <span class="dir">dtos/</span>
│   │   ├── <span class="file">auth.dto.ts</span>
│   │   ├── <span class="file">brand.dto.ts</span>
│   │   ├── <span class="file">car.dto.ts</span>
│   │   ├── <span class="file">city.dto.ts</span>
│   │   ├── <span class="file">color.dto.ts</span>
│   │   ├── <span class="file">driver.dto.ts</span>
│   │   ├── <span class="file">inscription.dto.ts</span>
│   │   └── <span class="file">travel.dto.ts</span>
│   └── <span class="dir">use-cases/</span>
│       ├── <span class="dir">auth/</span>                  <span class="comment"># login, register</span>
│       ├── <span class="dir">user/</span>                  <span class="comment"># get, list, update, anonymize, delete</span>
│       ├── <span class="dir">driver/</span>                <span class="comment"># create-driver</span>
│       ├── <span class="dir">travel/</span>                <span class="comment"># create, delete, find, get, list</span>
│       ├── <span class="dir">inscription/</span>           <span class="comment"># create, delete, list, user-inscriptions, passengers</span>
│       ├── <span class="dir">car/</span>                   <span class="comment"># create, delete, list, update</span>
│       ├── <span class="dir">brand/</span>                 <span class="comment"># create, delete, list</span>
│       ├── <span class="dir">city/</span>                  <span class="comment"># create, delete, list</span>
│       └── <span class="dir">color/</span>                 <span class="comment"># create, delete, list, update</span>
│
├── <span class="dir">infrastructure/</span>                    <span class="comment"># Implementations concretes</span>
│   ├── <span class="dir">database/</span>
│   │   ├── <span class="dir">prisma/</span>
│   │   │   ├── <span class="file">schema.prisma</span>      <span class="comment"># Schema BDD Neon PostgreSQL</span>
│   │   │   ├── <span class="dir">migrations/</span>
│   │   │   └── <span class="dir">generated/</span>         <span class="comment"># Client Prisma genere</span>
│   │   └── <span class="dir">repositories/</span>
│   │       ├── <span class="file">prisma-auth.repository.ts</span>
│   │       ├── <span class="file">prisma-user.repository.ts</span>
│   │       ├── <span class="file">prisma-driver.repository.ts</span>
│   │       ├── <span class="file">prisma-travel.repository.ts</span>
│   │       ├── <span class="file">prisma-inscription.repository.ts</span>
│   │       ├── <span class="file">prisma-car.repository.ts</span>
│   │       ├── <span class="file">prisma-model.repository.ts</span>
│   │       ├── <span class="file">prisma-brand.repository.ts</span>
│   │       ├── <span class="file">prisma-color.repository.ts</span>
│   │       └── <span class="file">prisma-city.repository.ts</span>
│   └── <span class="dir">services/</span>
│       ├── <span class="file">argon-password.service.ts</span>  <span class="comment"># Argon2 hashing</span>
│       ├── <span class="file">hono-jwt.service.ts</span>        <span class="comment"># JWT generation/verification</span>
│       └── <span class="file">resend-email.service.ts</span>    <span class="comment"># Resend email integration</span>
│
├── <span class="dir">presentation/</span>                      <span class="comment"># Hono routes & middlewares</span>
│   ├── <span class="dir">routes/</span>
│   │   ├── <span class="file">index.ts</span>               <span class="comment"># App setup, base path /api</span>
│   │   ├── <span class="file">auth.routes.ts</span>
│   │   ├── <span class="file">user.routes.ts</span>
│   │   ├── <span class="file">driver.routes.ts</span>
│   │   ├── <span class="file">travel.routes.ts</span>
│   │   ├── <span class="file">inscription.routes.ts</span>
│   │   ├── <span class="file">car.routes.ts</span>
│   │   ├── <span class="file">brand.routes.ts</span>
│   │   ├── <span class="file">city.routes.ts</span>
│   │   └── <span class="file">color.routes.ts</span>
│   ├── <span class="dir">controllers/</span>
│   │   ├── <span class="file">auth.controller.ts</span>
│   │   ├── <span class="file">user.controller.ts</span>
│   │   ├── <span class="file">driver.controller.ts</span>
│   │   ├── <span class="file">brand.controller.ts</span>
│   │   ├── <span class="file">car.controller.ts</span>
│   │   ├── <span class="file">city.controller.ts</span>
│   │   ├── <span class="file">color.controller.ts</span>
│   │   ├── <span class="file">inscription.controller.ts</span>
│   │   └── <span class="file">route.controller.ts</span>
│   ├── <span class="dir">middleware/</span>
│   │   ├── <span class="file">auth.middleware.ts</span>         <span class="comment"># Verifie x-auth-token JWT</span>
│   │   ├── <span class="file">authorization.middleware.ts</span> <span class="comment"># requireRole(USER/DRIVER/ADMIN)</span>
│   │   ├── <span class="file">error-handler.middleware.ts</span>
│   │   └── <span class="file">request-logger.middleware.ts</span>
│   └── <span class="dir">validators/</span>                <span class="comment"># Schemas Zod</span>
│       ├── <span class="file">auth.validator.ts</span>
│       ├── <span class="file">user.validator.ts</span>
│       ├── <span class="file">driver.validator.ts</span>
│       ├── <span class="file">brand.validator.ts</span>
│       ├── <span class="file">car.validator.ts</span>
│       ├── <span class="file">city.validator.ts</span>
│       ├── <span class="file">color.validator.ts</span>
│       ├── <span class="file">inscription.validator.ts</span>
│       └── <span class="file">route.validator.ts</span>
│
└── <span class="dir">lib/</span>                               <span class="comment"># Utilitaires partages</span>
    ├── <span class="dir">errors/</span>                        <span class="comment"># Systeme d erreurs type</span>
    │   ├── <span class="file">domain.errors.ts</span>
    │   ├── <span class="file">repository.errors.ts</span>
    │   ├── <span class="file">error-registry.ts</span>
    │   └── <span class="file">error.types.ts</span>
    ├── <span class="dir">logging/</span>                       <span class="comment"># Logger structure</span>
    │   └── <span class="file">logger.ts</span>
    └── <span class="dir">shared/</span>
        ├── <span class="dir">di/</span>
        │   ├── <span class="file">container.ts</span>           <span class="comment"># Injection de dependances</span>
        │   └── <span class="file">tokens.ts</span>              <span class="comment"># Tokens DI</span>
        ├── <span class="dir">types/</span>
        │   └── <span class="file">result.ts</span>              <span class="comment"># Type Result monadique</span>
        └── <span class="dir">utils/</span>
            ├── <span class="file">pagination.util.ts</span>
            └── <span class="file">result-response.util.ts</span>
  </div>

  <h3>Principes SOLID appliques</h3>
  <div class="arch-grid">
    <div class="arch-card">
      <h4>S — Single Responsibility</h4>
      <p>Chaque use case a une seule responsabilite. <code>create-inscription.use-case.ts</code> ne fait que la reservation.</p>
    </div>
    <div class="arch-card">
      <h4>O — Open/Closed</h4>
      <p>Les repositories sont ouverts a l'extension (nouvelles implementations) sans modifier le domaine.</p>
    </div>
    <div class="arch-card">
      <h4>L — Liskov Substitution</h4>
      <p><code>ArgonPasswordService</code> est substituable a <code>PasswordService</code> sans casser le comportement.</p>
    </div>
    <div class="arch-card">
      <h4>I — Interface Segregation</h4>
      <p>Interfaces specifiques par entite : <code>auth.repository.ts</code>, <code>user.repository.ts</code>, <code>travel.repository.ts</code>, etc.</p>
    </div>
    <div class="arch-card">
      <h4>D — Dependency Inversion</h4>
      <p>Le domaine depend d'abstractions (interfaces), pas de Prisma directement. Injection via <code>container.ts</code> + <code>tokens.ts</code>.</p>
    </div>
  </div>
</div>
</section>

<div style="padding:40px;text-align:center;color:var(--text-dim);font-size:0.82rem;">
  Analyse UML — API REST Covoiturage • Hono + Prisma + Neon PostgreSQL • Clean Architecture + SOLID + RGPD
</div>

<script>
mermaid.initialize({
  startOnLoad: true,
  theme: 'dark',
  themeVariables: {
    darkMode: true,
    background: '#15151a',
    primaryColor: '#00d4aa',
    primaryTextColor: '#f0f0f5',
    primaryBorderColor: '#2a2a35',
    lineColor: '#7a7a8c',
    secondaryColor: '#1e1e26',
    tertiaryColor: '#25252f',
    fontFamily: 'DM Sans, sans-serif',
    fontSize: '14px'
  },
  flowchart: { curve: 'basis', padding: 20 },
  sequence: { mirrorActors: false, messageAlign: 'center' }
});
</script>
</body>
</html>